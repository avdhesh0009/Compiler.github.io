<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compiler</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="codemirror-5.65.15/lib/codemirror.css">
    <script src="codemirror-5.65.15/lib/codemirror.js"></script>
    <script src="codemirror-5.65.15/mode/clike/clike.js"></script>
    <link rel="stylesheet" href="codemirror-5.65.15/theme/dracula.css">
    <script src="codemirror-5.65.15/addon/edit/closebrackets.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script src="codemirror-5.65.15/mode/python/python.js"></script>
</head>
<body style="background-color:#14315e;">
    <h1 style="text-align: center;color:white;text-transform: uppercase; margin-top:1.5rem;margin-bottom:1.5rem;">Code Editor</h1>
    <div class="row m-3">
        <div class="col">
          <div class="d-flex justify-content-between mb-2 rounded p-2 flex-wrap" style="background-color: #282a36;">
            <div class="col-12 w-25">
                <label class="visually-hidden" for="inlineFormSelectPref">Preference</label>
                <select class="form-select" id="inlineFormSelectPref" style="background-color: #14315e;color:white;font-weight: 600;font-size:20px;cursor: pointer;">
                  <option selected >Choose...</option>
                  <option value="Java">Java</option>
                  <option value="Cpp">Cpp</option>
                  <option value="Python">Python</option>
                </select>
              </div> 
              <div >
                <!-- <button type="button" class="btn btn-success">Run Code</button> -->
                <button type="button"  id="run" style="background-color: #14315e;border:1px solid white;color:white;font-size:20px;font-weight: 600;border-radius:0.5rem;padding:0.4rem 1rem;">Run Code<i class="bi bi-play-fill" style="padding-left:0.2rem;"></i></button>
              </div>           
          </div>
          <textarea type="text" id="editor" class="form-control"  aria-label="First name"></textarea>
        </div>
        <div class="col d-flex flex-column rounded px-4 flex-wrap" style="background-color:  #282a36;">
           <div class="h-50 ">
              <label for="Input" class="text-light mt-4 mb-2" style="font-weight: 600;font-size:20px;" >Input</label>
              <textarea type="text" id="input" class="form-control h-75"  aria-label="Last name" style="background-color: #14315e;color:white;"></textarea>
           </div>
           <div class="h-50 ">
            <label for="Output" class="text-light mb-2"  style="font-weight: 600;font-size:20px;">Output</label>
            <textarea type="text" id="output" class="form-control h-75" style="background-color: #14315e;color:white;" aria-label="Last name"></textarea>
         </div>
        </div>
      </div>
</body>
<script>
  var editor=CodeMirror.fromTextArea(document.getElementById("editor"),{
    mode:"text/x-c++src",
    theme:"dracula",
    lineNumbers:true,
    autoCloseBrackets:true,
  })
 var width=window.innerWidth
 var input=document.getElementById("input")
 var output=document.getElementById("output")
 var run=document.getElementById("run")
 editor.setSize(0.7*width,"500")
 var option=document.getElementById("inlineFormSelectPref")
 option.addEventListener("change",function(){
    if(option.value=="Java"){
        editor.setOption("mode","text/x-java")
    }
    else if(option.value=="python"){
        editor.setOption("mode","text/x-python")
    }
    else{
        editor.setOption("mode","text/x-c++src")
    }
 })
 var code;
 run.addEventListener("click",async function(){
    code={
        code:editor.getValue(),
        input:input.value,
        lang:option.value
    }
    var oData=await fetch("http://localhost:8000/compile",{
        method:"POST",
        headers:{
            "Content-Type":"application/json"
        },
        body:JSON.stringify(code)
    })
    var d=await oData.json()
    output.value=d.output
 })
</script>
</html>